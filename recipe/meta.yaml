{% set version = "1.0.0" %}

package:
  name: atlasgo
  version: {{ version }}

source:
  url: https://github.com/ariga/atlas/archive/refs/tags/v{{ version }}.tar.gz
  sha256: 06c0d2488147466d88aaf14d7ecd6ea9f7f94763cfa45b88689d299b9a496e1b
  patches:
    # NOTE: Required to circumvent issues with the atlas SDK (cf. https://github.com/ariga/atlas-go-sdk/pull/66).
    - patches/001-remove-unofficial-string.patch

build:
  # NOTE: Windows is not supported. osx-64 is skipped because Go 1.21+ requires
  #       macOS 12.0+ for SecTrustCopyCertificateChain, which isn't available in
  #       conda-forge's osx-64 SDK.
  skip: true  # [win or (osx and x86_64)]
  number: 0

requirements:
  build:
    - {{ compiler('c') }}      # [unix]
    - {{ stdlib('c') }}        # [unix]
    - {{ compiler('go-cgo') }} >=1.21
    - go-licenses

test:
  commands:
    - atlas version | grep "atlas version v{{ version }}"
    - atlas --help

about:
  home: https://atlasgo.io
  license: Apache-2.0
  license_file:
    - LICENSE
    - library_licenses/
  summary: Manage your database schema as code
  doc_url: https://atlasgo.io/getting-started
  dev_url: https://github.com/ariga/atlas

extra:
  recipe-maintainers:
    - borchero
